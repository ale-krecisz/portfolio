{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nexports.default = function () {\n  return function spritesheetParser(resource, next) {\n    var imageResourceName = resource.name + '_image'; // skip if no data, its not json, it isn't spritesheet data, or the image resource already exists\n\n    if (!resource.data || resource.type !== _resourceLoader.Resource.TYPE.JSON || !resource.data.frames || this.resources[imageResourceName]) {\n      next();\n      return;\n    }\n\n    var loadOptions = {\n      crossOrigin: resource.crossOrigin,\n      loadType: _resourceLoader.Resource.LOAD_TYPE.IMAGE,\n      metadata: resource.metadata.imageMetadata,\n      parentResource: resource\n    };\n    var resourcePath = getResourcePath(resource, this.baseUrl); // load the image for this sheet\n\n    this.add(imageResourceName, resourcePath, loadOptions, function onImageLoad(res) {\n      var spritesheet = new _core.Spritesheet(res.texture.baseTexture, resource.data, resource.url);\n      spritesheet.parse(function () {\n        resource.spritesheet = spritesheet;\n        resource.textures = spritesheet.textures;\n        next();\n      });\n    });\n  };\n};\n\nexports.getResourcePath = getResourcePath;\n\nvar _resourceLoader = require('resource-loader');\n\nvar _url = require('url');\n\nvar _url2 = _interopRequireDefault(_url);\n\nvar _core = require('../core');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction getResourcePath(resource, baseUrl) {\n  // Prepend url path unless the resource image is a data url\n  if (resource.isDataUrl) {\n    return resource.data.meta.image;\n  }\n\n  return _url2.default.resolve(resource.url.replace(baseUrl, ''), resource.data.meta.image);\n}","map":null,"metadata":{},"sourceType":"script"}